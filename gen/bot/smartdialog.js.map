{"version":3,"sources":["/projects/nodejs/botbuilder/fdevstart/src/../src/bot/smartdialog.ts"],"names":[],"mappings":"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","file":"bot/smartdialog.js","sourcesContent":["/**\n * The bot implementation\n *\n * Instantiate apssing a connector via\n * makeBot\n *\n */\n/**\n * @file\n * @module jfseb.fdevstart.smartdialog\n * @copyright (c) 2016 Gerd Forstmann\n */\n//declare module 'elizabot' { };\n//declare module 'winston-pg' { };\n//delcare module 'winston' {};\n\nimport * as builder from 'botbuilder';\nimport * as debug from 'debug';\n\nimport * as Exec from '../exec/exec';\nimport * as Match from '../match/match';\n\nimport * as Analyze from '../match/analyze';\nimport * as BreakDown from '../match/breakdown';\n\nimport * as WhatIs from '../match/whatis';\nimport * as ListAll from '../match/listall';\nimport * as Describe from '../match/describe';\nimport * as MakeTable from '../exec/makeTable';\n\nimport * as Utils from '../utils/utils';\nimport * as ErError from '../match/ererror';\n\nimport * as _ from 'lodash';\n\nimport * as DialogLogger from '../utils/dialoglogger';\n\nimport * as process from 'process';\n\nvar dburl = process.env.DATABASE_URL || \"\";\n\nvar pglocalurl = \"postgres://joe:abcdef@localhost:5432/abot\";\nvar dburl = process.env.DATABASE_URL || pglocalurl;\nimport * as pg from 'pg';\nvar o = pg as any;\nif(!(process.env.ABOT_DBNOSSL)) {\n  o.defaults.ssl = true; // Only used internally !\n}\nvar dialogLogger = DialogLogger.logger(\"smartbot\", dburl, pg);\n\ntype stringOrMessage = string | builder.Message;\nfunction send<T extends stringOrMessage>(o: T): T { return o; };\nfunction dialoglog(intent: string, session: builder.Session, response: stringOrMessage) {\n  var sResponse: string;\n  var sAction: string;\n  if (typeof response === \"string\") {\n    sAction = \"\";\n    sResponse = response;\n  } else {\n    var aMessage: builder.Message = response;\n    var iMessage: builder.IMessage = aMessage.toMessage();\n    sResponse = iMessage.text;\n    sAction = (iMessage.entities && iMessage.entities[0]) ? (JSON.stringify(iMessage.entities && iMessage.entities[0])) : \"\";\n  }\n  dialogLogger({\n    intent: intent,\n    session: session,\n    response: sResponse,\n    action: sAction\n  });\n  session.send(response);\n}\n\n//const pgLogger = new PgLogger({\n//  name: 'test-logger',\n//  level: 'debug',\n//  connString: 'postgres://ubuntu@localhost:5432/circle_test',\n//  tableName: 'winston_logs',\n//});\n\n\n\n//winston.add(winston.transports.File, { filename: 'winston_out.log', timestamp : true });\n//  winston.remove(winston.transports.Console);\n//winston.add(pgLogger);\n\n/*\nconst logger = new winston.Logger({\n  transports: [\n    new winston.transports.Console({\n      color: true,\n      timestamp: true,\n    }),\n    pgLogger,\n  ]\n});\n*/\n//pgLogger.initTable(done);\n\n\nvar elizabot = require('../extern/elizabot/elizabot.js');\n//import * as elizabot from 'elizabot';\n\nlet debuglog = debug('smartdialog');\nimport * as PlainRecognizer from './plainrecognizer';\n//var builder = require('botbuilder');\n\nvar dispatcher = require('../match/dispatcher.js').dispatcher;\n\n\nfunction getConversationId(session: builder.Session): string {\n  return session.message &&\n    session.message.address &&\n    session.message.address.conversation.id;\n}\n\nvar elizabots = {};\n\nfunction getElizaBot(id: string) {\n  if (!elizabots[id]) {\n    elizabots[id] = {\n      access: new Date(),\n      elizabot: new elizabot()\n    };\n  }\n  elizabots[id].access = new Date();\n  return elizabots[id].elizabot;\n}\n\nimport * as IMatch from '../match/ifmatch';\nimport * as Tools from '../match/tools';\n\nvar newFlow = true;\n\nimport * as Model from '../model/model';\nimport * as ExecServer from '../exec/execserver';\n\n//const theDefaultModel = Model.loadModels();\n\nvar models = {};\n\nfunction loadModel(modelPath?: string): IMatch.IModels {\n  modelPath = modelPath || \"\";\n  if (!models[modelPath]) {\n    models[modelPath] = Model.loadModels(modelPath);\n  }\n  return models[modelPath];\n}\n\nif (newFlow) {\n\n} else {\n\n  //const tools = Tools.getTools();\n  //const InputFilterRules = require('../match/inputFilterRules.js');\n  //const mRules = InputFilterRules.getMRulesSample();\n}\n\nfunction isAnonymous(userid: string): boolean {\n  return userid.indexOf(\"ano:\") === 0;\n}\n\nfunction restrictLoggedOn(session: builder.Session, arr: any[]): any[] {\n  var userid = session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\";\n  if (process.env.ABOT_EMAIL_USER && isAnonymous(userid)) {\n    if (arr.length < 6) {\n      return arr;\n    }\n    var len = arr.length;\n    var res = arr.slice(0, Math.min(Math.max(Math.floor(arr.length / 3), 7), arr.length));\n    if (typeof arr[0] === \"string\") {\n      var delta = len - res.length;\n      res.push(\"... and \" + delta + \" more entries for registered users\");\n    }\n    return res;\n  }\n  return arr;\n}\n\n/*\nexport class SimpleRecognizer implements builder.IIntentRecognizer {\n  constructor() {\n\n  }\n\n  recognize(context: builder.IRecognizeContext, callback: (err: Error, result: builder.IIntentRecognizerResult) => void): void {\n    var u = {} as builder.IIntentRecognizerResult;\n\n    debuglog(\"recognizing \" + context.message.text);\n    if (context.message.text.indexOf(\"start\") >= 0) {\n      u.intent = \"ShowEntity\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"start \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n\n    if (context.message.text.indexOf(\"train\") >= 0) {\n      u.intent = \"train\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"learn\") >= 0) {\n      u.intent = \"learn\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.type = \"trainFact\";\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"help\") >= 0) {\n      u.intent = \"help\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"exit\") >= 0) {\n      u.intent = \"exit\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"exit \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"wrong\") >= 0) {\n      u.intent = \"wrong\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"exit \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    debuglog('recognizing nothing');\n    u.intent = \"None\";\n    u.score = 0.1;\n    var e1 = {} as builder.IEntity;\n    e1.startIndex = \"exit \".length;\n    e1.endIndex = context.message.text.length;\n    e1.score = 0.1;\n    u.entities = [];\n    callback(undefined, u);\n  }\n}\n*/\n\nconst aTrainReplies = [\"Thank you for sharing this suggestion with us\",\n  \"Thank for for this valuable information.\",\n  \"Thank for for this interesting fact!\",\n  \"Thats a plethoria of information.\",\n  \"That's a nugget of information.\",\n  \"Lovely, I may consider you input.\",\n  \"Well done, anything more to let me know?\",\n  \"I do appreciate your teaching and my learning experience, or was it the other way round?\",\n  \"Your helpful input has been stored in some dusty corner of the World wide web!\",\n  \"Thank you for my learning experience!\",\n  \"I have incorporated your valuable suggestion in the wisdom of the internet\"\n];\n\nvar aTrainDialog = aTrainReplies;\n\nvar aTrainExitHint = [\n  \"\\ntype \\\"done\\\" when you are done training me.\",\n  \"\",\n  \"\",\n  \"\",\n  \"\\nremember, you are stuck here instructing me, type \\\"done\\\" to return.\",\n  \"\"];\n\nconst aEnterTrain = ['So you think this is wrong? You can offer your advise here.\\n Type \"done\" if you are done with instructing me',\n  'Feel free to offer me your better solution here.\\nType \"done\" if you are done with instructing me',\n  'Some say \"The secret to happiness is to lower your expectations to the point they are already met.\", \\nt if you could help me to become better, instruct me.\\n Type \"done\" if you are done with teaching me',\n  'Feel free to offer me your better solution here.\\n Type \"done\" if you are done with instructing me',\n  'Feel free to offer me your better solution here.\\n Type \"done\" if you are done with instructing me',\n];\nconst aBackFromTraining = [\n  'Puuh, back from training! Now for the easy part ...\\n ask me a new question.',\n  'Live and don\\'t learn, that\\'s us. Naah, we\\'ll see.\\nAsk me another question.',\n  'The secret to happiness is to lower your expectations to the point they are already met.\\n Ask me a question.',\n  'Thanks for having this lecture session, now i am back to our usual self.\\n Ask me a question.'\n];\n\n\nconst aTrainNoKlingon = [\n  \"He who master the dark arts of SAP must not dwell in the earthly realms of Start Trek.\",\n  \"SAP is a cloud company, not a space company.\",\n  \"The depth of R/3 are deeper than Deep Space 42.\",\n  \"My brainpower is fully absorbed with mastering other realms.\",\n  \"For the wosap, the sky is the limit. Feel free to check out nasa.gov .\",\n  \"The future is SAP or IBM blue, not space black.\",\n  \"That's left to some musky future.\"\n]\n\nexport const aResponsesOnTooLong = [\n  \"Your input should be eloquent in it's brevity. This one was too long.\",\n  \"my wisdom is severly bound by my limited input processing capabilities. Could you formulate a shorter input? Thank you.\",\n  \"The length of you input indicates you probably know more about the topic than me? Can i humbly ask you to formulate a shorter question?\",\n  '\\\"What ever you want to teach, be brief\\\" (Horace). While this does not always applies to my answers, it is require for your questions. Please try again with a refined questions.',\n  'I understand more than 4-letter words, but not more than 20 word sentences. Please try to shorten your input.',\n  'the sky is the limit? Air force member or not, you can ask longer questions than \\\"the sky\\\", but not this long',\n  'My answers may be exhaustive, but I understand more than 4-letter words, but not more than 20 word sentences. Sorry.',\n  'Our conversation must be highly assymmetric: my answers may be verbose and exhaustive and fuzzy, questions and input must be brief. Try to reformulate it',\n];\n\n\nexport const metawordsDescriptions = {\n        \"category\": \"an attribute of a record in a model, example: a Planet has a \\\"name\\\" attribute\",\n        \"domain\": \"a group of facts which are typically unrelated\",\n        \"key\": \"an attribute value (of a category) which  is unique for the record\",\n        \"tool\": \"is potentialy command to execute\",\n        \"record\": \"a specific set of \\\"fact\\\"s of a domain, a \\\"record\\\" has a set of attributes values (\\\"fact\\\"s) of the categories, often a record has a \\\"key\\\"\",\n        \"fact\": \"a specific category value of a record in a domain, may be a \\\"key\\\" value\",\n      };\n\nfunction getRandomResult(arr: string[]): string {\n  return arr[Math.floor(Math.random() * arr.length) % arr.length];\n}\n\nexport class SimpleUpDownRecognizer implements builder.IIntentRecognizer {\n  constructor() {\n\n  }\n\n  recognize(context: builder.IRecognizeContext, callback: (err: Error, result: builder.IIntentRecognizerResult) => void): void {\n    var u = {} as builder.IIntentRecognizerResult;\n\n    debuglog(\"recognizing \" + context.message.text);\n    if (context.message.text.indexOf(\"down\") >= 0) {\n      u.intent = \"intent.down\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"start \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"up\") >= 0) {\n      u.intent = \"intent.up\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"up\".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"done\") >= 0) {\n      u.intent = \"intent.up\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"up\".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"exit\") >= 0) {\n      u.intent = \"intent.up\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"up\".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"quit\") >= 0) {\n      u.intent = \"intent.up\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"up\".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    debuglog('recognizing nothing');\n    u.intent = \"None\";\n    u.score = 0.1;\n    var e1 = {} as builder.IEntity;\n    e1.startIndex = \"exit \".length;\n    e1.endIndex = context.message.text.length;\n    e1.score = 0.1;\n    u.entities = [];\n    callback(undefined, u);\n  }\n}\n\nconst AnyObject = Object as any;\n// globalTunnel.initialize({\n//  host: 'proxy.exxxample.com',\n//  port: 8080\n// })\n\n// Create bot and bind to console\n// var connector = new htmlconnector.HTMLConnector()\n\n// connector.setAnswerHook(function (sAnswer) {\n//  console.log('Got answer : ' + sAnswer + '\\n')\n// })\n\nvar bot;\n// setTimeout(function () {\n//   connector.processMessage('start unit test ABC ')\n// }, 5000)\n\nimport * as fs from 'fs';\n\nvar oJSON = JSON.parse('' + fs.readFileSync('./resources/model/intents.json'));\nvar oRules = PlainRecognizer.parseRules(oJSON);\n// var Recognizer = new (recognizer.RegExpRecognizer)(oRules);\n\n\nfunction logQuery(session: builder.Session, intent: string, result?: Array<IMatch.IToolMatch>) {\n\n  fs.appendFile('./logs/showmequeries.txt', \"\\n\" + JSON.stringify({\n    text: session.message.text,\n    timestamp: session.message.timestamp,\n    intent: intent,\n    res: result && result.length && Match.ToolMatch.dumpNice(result[0]) || \"0\",\n    conversationId: session.message.address\n    && session.message.address.conversation\n    && session.message.address.conversation.id || \"\",\n    userid: session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\"\n  }), function (err, res) {\n    if (err) {\n      debuglog(\"logging failed \" + err);\n    }\n  });\n}\n\n\n\nfunction logQueryWhatIs(session: builder.Session, intent: string, result?: Array<IMatch.IWhatIsAnswer>) {\n\n  fs.appendFile('./logs/showmequeries.txt', \"\\n\" + JSON.stringify({\n    text: session.message.text,\n    timestamp: session.message.timestamp,\n    intent: intent,\n    res: result && result.length && WhatIs.dumpNice(result[0]) || \"0\",\n    conversationId: session.message.address\n    && session.message.address.conversation\n    && session.message.address.conversation.id || \"\",\n    userid: session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\"\n  }), function (err, res) {\n    if (err) {\n      debuglog(\"logging failed \" + err);\n    }\n  });\n}\n\nfunction logQueryWhatIsTupel(session: builder.Session, intent: string, result?: Array<IMatch.IWhatIsTupelAnswer>) {\n\n  fs.appendFile('./logs/showmequeries.txt', \"\\n\" + JSON.stringify({\n    text: session.message.text,\n    timestamp: session.message.timestamp,\n    intent: intent,\n    res: result && result.length && WhatIs.dumpNiceTupel(result[0]) || \"0\",\n    conversationId: session.message.address\n    && session.message.address.conversation\n    && session.message.address.conversation.id || \"\",\n    userid: session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\"\n  }), function (err, res) {\n    if (err) {\n      debuglog(\"logging failed \" + err);\n    }\n  });\n}\n\nvar gwords = {};\n/**\n * Construct a bot\n * @param connector {Connector} the connector to use\n * HTMLConnector\n * or connector = new builder.ConsoleConnector().listen()\n */\nfunction makeBot(connector, modelPath?: string, options? : any ) {\n  var t = Date.now();\n  var theModel = loadModel(modelPath);\n  var t = Date.now() - t;\n  if (options && options.showModelLoadTime) {\n    console.log(`model load time ${(t)}`);\n  }\n\n  bot = new builder.UniversalBot(connector);\n\n\n\n  // Create LUIS recognizer that points at our model and add it as the root '/' dialog for our Cortana Bot.\n  // var model = sensitive.modelurl;\n  // var model = 'https://api.projectoxford.ai/luis/v2.0/apps/c413b2ef-382c-45bd-8ff0-f76d60e2a821?subscription-key=c21398b5980a4ce09f474bbfee93b892&q='\n  var recognizer = new PlainRecognizer.RegExpRecognizer(oRules);\n\n  var dialog = new builder.IntentDialog({ recognizers: [recognizer] });\n  // dialog.onBegin(function(session,args) {\n  // console.log(\"beginning ...\")\n  // session.dialogData.retryPrompt = args && args.retryPrompt || \"I am sorry\"\n  // session.send(\"What do you want?\")\n  //\n  // })\n\n  var dialogUpDown = new builder.IntentDialog({ recognizers: [new SimpleUpDownRecognizer()] });\n\n  bot.dialog('/updown', dialogUpDown);\n  dialogUpDown.onBegin(function (session) {\n    dialoglog(\"TrainMe\", session, send(getRandomResult(aEnterTrain)));\n    //session.send(\"Hi there, updown is waiting for you\");\n  })\n\n  dialogUpDown.matches('intent.up', [\n    function (session, args, next) {\n      session.dialogData.abc = args || {};\n      builder.Prompts.text(session, 'you want to exit training? type \\\"done\\\" again.');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = results.reponse;\n      next();\n    },\n    function (session, results) {\n      session.endDialogWithResult({ response: session.dialogData.abc });\n    }\n  ]\n  );\n\n  dialogUpDown.matches('intent.down', [\n    function (session, args, next) {\n      session.dialogData.abc = args || {};\n      builder.Prompts.text(session, 'you want to go down!');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = -1; // results.reponse;\n      next();\n    },\n    function (session, results) {\n      session.send(\"still going down?\");\n    }\n  ]\n  );\n  dialogUpDown.onDefault(function (session) {\n    logQuery(session, \"onDefault\");\n    var res = getRandomResult(aTrainDialog) + getRandomResult(aTrainExitHint);\n    dialoglog(\"TrainMe\", session, send(res));\n  });\n\n\n  bot.dialog('/train', [\n    function (session, args, next) {\n      session.dialgoData.abc = args || {};\n      builder.Prompts.text(session, 'Do you want to train me');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = results.reponse;\n    },\n    function (session, results) {\n      session.endDialogWithResult({ response: session.DialogData.abc });\n    }\n  ]);\n\n\n  bot.dialog('/', dialog);\n\n  dialog.matches('ShowMe', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      debuglog(\"Show Entity\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var a1 = builder.EntityRecognizer.findEntity(args.entities, 'A1');\n      const result = Analyze.analyzeAll(a1.entity,\n        theModel.rules, theModel.tools, gwords);\n      logQuery(session, 'ShowMe', result);\n      // test.expect(3)\n      //  test.deepEqual(result.weight, 120, 'correct weight');\n      if (!result || result.length === 0) {\n        next();\n      }\n      // debuglog('result : ' + JSON.stringify(result, undefined, 2));\n      debuglog('best result : ' + JSON.stringify(result[0] || {}, undefined, 2));\n      debuglog('top : ' + Match.ToolMatch.dumpWeightsTop(result, { top: 3 }));\n\n      if (Analyze.isComplete(result[0])) {\n        session.dialogData.result = result[0];\n        //    session.send('Showing entity ...');\n        next();\n      } else if (Analyze.getPrompt(result[0])) {\n        var prompt = Analyze.getPrompt(result[0]);\n        session.dialogData.result = result[0];\n        session.dialogData.prompt = prompt;\n        dialoglog(\"ShowMe\", session, send(\"Not enough information supplied: \" + Match.ToolMatch.dumpNice(\n          session.dialogData.result\n        )));\n        builder.Prompts.text(session, prompt.text);\n      } else {\n        var best = result.length ? Match.ToolMatch.dumpNice(result[0]) : \"<nothing>\";\n        dialoglog(\"ShowMe\", session, send('I did not understand this' + best));\n      }\n    },\n    function (session, results, next) {\n      var result = session.dialogData.result;\n      if (!result || result.length === 0) {\n        next();\n      }\n\n      if (results.response) {\n        // some prompting\n        Analyze.setPrompt(session.dialogData.result, session.dialogData.prompt, results.response);\n      }\n      if (Analyze.isComplete(session.dialogData.result)) {\n        next();\n      } else if (Analyze.getPrompt(session.dialogData.result)) {\n        var prompt = Analyze.getPrompt(session.dialogData.result);\n        session.dialogData.prompt = prompt;\n        builder.Prompts.text(session, prompt.text);\n      }\n    },\n    function (session, results, next) {\n      var result = session.dialogData.result;\n      if (results.response) {\n        // some prompting\n        Analyze.setPrompt(session.dialogData.result,\n          session.dialogData.prompt, results.response);\n      }\n      if (Analyze.isComplete(session.dialogData.result)) {\n        const exec = ExecServer.execTool(session.dialogData.result as IMatch.IToolMatch, theModel.records);\n\n        var reply = new builder.Message(session)\n          .text(exec.text)\n          .addEntity(exec.action);\n        // .addAttachment({ fallbackText: \"I don't know\", contentType: 'image/jpeg', contentUrl: \"www.wombat.org\" });\n        dialoglog(\"ShowMe\", session, send(reply));\n\n      } else {\n        if (session.dialogData.result) {\n          dialoglog(\"ShowMe\",\n            session, send(\"Not enough information supplied: \" + Match.ToolMatch.dumpNice(\n              session.dialogData.result\n            )));\n        } else {\n          dialoglog(\"ShowMe\", session, send(\"I did not get what you want\"));\n        }\n      }\n    },\n  ]);\n\n  dialog.matches('WhatIs', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"WhatIs Entities\");\n      debuglog(debuglog.enabled? ('raw: ' + JSON.stringify(args.entities, undefined, 2)): '-');\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'category');\n      var category = categoryEntity.entity;\n      var a1 = builder.EntityRecognizer.findEntity(args.entities, 'A1');\n      var cats = [];\n      try {\n        cats = WhatIs.analyzeCategoryMultOnlyAndComma(category, theModel.rules, message);\n        debuglog(\"here cats\" + cats.join(\",\"));\n      } catch (e) {\n        if (e) {\n          debuglog(\"here exception\" + e);\n          dialoglog(\"WhatIs\", session, send('I don\\'t know anything about \"' + category +\n            (e ? '(' + e.toString() + ')' : \"\")));\n          // next();\n          return;\n        }\n      }\n\n      var cat = undefined;\n      // we have some cats, (or at least one)\n      if (cats.length === 1) {\n        cat = cats[0];\n        if (!cat) {\n          session.send('I don\\'t know anything about \"' + category + '\"');\n          // next();\n          return;\n        }\n      }\n      if (cats.length === 1) {\n        debuglog('category identified:' + cat);\n        const result = WhatIs.resolveCategory(cat, a1.entity,\n          theModel.rules, theModel.records);\n        debuglog(debuglog.enabled? ('whatis result:' + JSON.stringify(result)):'-');\n        logQueryWhatIs(session, 'WhatIs', result.answers);\n        var indis = WhatIs.isIndiscriminateResult(result.answers);\n        if (indis) {\n          session.send(indis);\n          // next();\n          return;\n        }\n        if (!result || result.answers.length === 0) {\n          var explain = '';\n          if(result.errors.length) {\n            explain = ErError.explainError(result.errors);\n          }\n          dialoglog(\"WhatIs\", session, send('I don\\'t know anything about \"' + cat + \" (\" + category + ')\\\" in relation to \"' + a1.entity + `\".${explain}`));\n          // next();\n          return;\n        } else {\n          // debuglog('result : ' + JSON.stringify(result, undefined, 2));\n          debuglog(debuglog.enabled?('best result : ' + JSON.stringify(result.answers[0] || {}, undefined, 2)):'-');\n          debuglog(debuglog.enabled? ('top : ' + WhatIs.dumpWeightsTop(result.answers, { top: 3 })): '-');\n          // TODO cleansed sentence\n          dialoglog(\"WhatIs\", session, send('The ' + category + ' of ' + a1.entity + ' is ' + result.answers[0].result + \"\\n\")); //  + JSON.stringify(result[0]));\n        }\n      } // single category\n      else {\n        debuglog('categories identified:' + cats.join(\",\"));\n        const resultArr = WhatIs.resolveCategories(cats, a1.entity,\n          theModel);\n        debuglog(debuglog.enabled ? ('mulst whatis result:' + JSON.stringify(resultArr)):'-');\n        logQueryWhatIsTupel(session, 'WhatIs', resultArr.tupelanswers);\n        var indis = WhatIs.isIndiscriminateResultTupel(resultArr.tupelanswers);\n        if (indis) {\n          session.send(indis);\n          // next();\n          return;\n        }\n        if (!resultArr || !resultArr.tupelanswers || resultArr.tupelanswers.length === 0) {\n          var explain = '';\n          if(resultArr.errors.length) {\n            explain = ErError.explainError(resultArr.errors);\n          }\n          dialoglog(\"WhatIs\", session, send('I don\\'t know anything about \"' + category + \"\\\" (\" + Utils.listToQuotedCommaAnd(cats) + ')\\\" in relation to \"' + a1.entity + `\"${explain}`));\n          // next();\n          return;\n        } else {\n          // debuglog('result : ' + JSON.stringify(result, undefined, 2));\n          debuglog(debuglog.enabled? ('best result : ' + JSON.stringify(resultArr.tupelanswers[0] || {}, undefined, 2)):'-');\n          //debuglog('top : ' + WhatIs.dumpWeightsTop(resultArr, { top: 3 }));\n          // TODO cleansed sentence\n          dialoglog(\"WhatIs\", session, send('The ' + Utils.listToQuotedCommaAnd(cats) + ' of ' + a1.entity + ' are ' + Utils.listToQuotedCommaAnd(resultArr.tupelanswers[0].result) + '\\n')); //  + JSON.stringify(result[0]));\n        }\n      } //endif multiple categories\n    }\n  ]);\n\n\n  dialog.matches('ListAll', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : ListAll\");\n      debuglog(debuglog.enabled? ('raw: ' + JSON.stringify(args.entities, undefined, 2)) :'-');\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'categories');\n      var category = categoryEntity.entity;\n      var a1 = builder.EntityRecognizer.findEntity(args.entities, 'insth');\n      if (category === \"categories\") {\n        // do we have a filter ?\n        var domain = undefined;\n        if (a1 && a1.entity) {\n          domain = ListAll.inferDomain(theModel, a1.entity);\n        }\n        if (!domain) {\n          var res = restrictLoggedOn(session, theModel.category).join(\";\\n\");\n          if (a1 && a1.entity) {\n            dialoglog(\"ListAll\", session, send(\"I did not infer a domain restriction from \\\"\" + a1.entity + \"\\\", all my categories are ...\\n\" + res));\n          } else {\n            dialoglog(\"ListAll\", session, send(\"my categories are ...\\n\" + res));\n          }\n          return;\n        } else {\n          var aRes = Model.getCategoriesForDomain(theModel, domain);\n          var res = restrictLoggedOn(session, aRes).join(\";\\n\");\n          dialoglog(\"ListAll\", session, send(\"my categories in domain \\\"\" + domain + \"\\\" are ...\\n\" + res));\n          return;\n        }\n      }\n      if (category === \"domains\") {\n        var res = restrictLoggedOn(session, theModel.domains).join(\";\\n\");\n        dialoglog(\"ListAll\", session, send(\"my domains are ...\\n\" + res));\n        return;\n      }\n      if (category === \"tools\") {\n        var res = restrictLoggedOn(session, theModel.tools).map(function (oTool) {\n          return oTool.name;\n        }).join(\";\\n\");\n        dialoglog(\"ListAll\", session, send(\"my tools are ...\\n\" + res));\n        return;\n      }\n      var cats = [];\n      try {\n        cats = WhatIs.analyzeCategoryMultOnlyAndComma(category, theModel.rules, message);\n        debuglog(\"here cats\" + cats.join(\",\"));\n      } catch (e) {\n        if (e) {\n          debuglog(\"here exception\" + e);\n          dialoglog(\"WhatIs\", session, send('I don\\'t know anything about \"' + category + '\"(' + e.toString() + ')'));\n          // next();\n          return;\n        }\n      }\n      if (!cats || (cats.length === 0)) {\n        dialoglog(\"ListAll\", session, send('I don\\'t know anything about \"' + category + '\"'));\n        // next();\n        return;\n      }\n      var cat = \"\";\n      if (cats.length === 1) {\n        cat = cats[0];\n      }\n      if (cats.length === 1) {\n        debuglog('category identified:' + cat);\n        if (a1 && a1.entity) {\n          debuglog('got filter:' + a1.entity);\n          var categorySet = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, true);\n          var result1 = ListAll.listAllWithContext(cat, a1.entity,\n            theModel.rules, theModel.records, categorySet);\n          // TODO classifying the string twice is a terrible waste\n          if (!result1.length) {\n            debuglog('going for having');\n            var categorySetFull = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, false);\n            result1 = ListAll.listAllHavingContext(cat, a1.entity, theModel.rules,\n              theModel.records, categorySetFull).answers;\n          }\n          debuglog(debuglog? ('listall result:' + JSON.stringify(result1)):'-');\n          var joinresults = restrictLoggedOn(session, ListAll.joinResults(result1));\n          logQueryWhatIs(session, 'ListAll', result1);\n          if (joinresults.length) {\n            dialoglog(\"ListAll\", session, send(\"the \" + category + \" for \" + a1.entity + \" are ...\\n\" + joinresults.join(\";\\n\")));\n          } else {\n            dialoglog(\"ListAll\", session, send(\"i did not find any \" + category + \" for \" + a1.entity + \".\\n\" + joinresults.join(\";\\n\")));\n          }\n          return;\n        } else {\n          // no entity, e.g. list all countries\n          //\n          var categorySetFull = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, false);\n          var result = ListAll.listAllHavingContext(cat, cat, theModel.rules, theModel.records, categorySetFull);\n          logQueryWhatIs(session, 'ListAll', result.answers);\n          if (result.answers.length) {\n            debuglog(debuglog.enabled ? ('listall result:' + JSON.stringify(result)): '-');\n            var joinresults = [];\n            debuglog(\"here is cat>\" + cat);\n            if (cat !== \"example question\") {\n              joinresults = restrictLoggedOn(session, ListAll.joinResults(result.answers));\n            } else {\n              joinresults = ListAll.joinResults(result.answers);\n            }\n            var response = \"the \" + category + \" are ...\\n\" + joinresults.join(\";\\n\");\n            dialoglog(\"ListAll\", session, send(response));\n            return;\n          } else {\n            var response = \"Found no data having \\\"\" + cat + \"\\\"\"\n            dialoglog(\"ListAll\", session, send(response));\n            return;\n          }\n        }\n      } else {\n        // multiple categories\n        debuglog('categories identified:' + cats.join(\",\"));\n        if (a1 && a1.entity) {\n          debuglog('got filter:' + a1.entity);\n          try {\n            var categorySet = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, true);\n          } catch (e) {\n            debuglog(\"here exception\" + e);\n            dialoglog(\"WhatIs\", session, send('I cannot combine \"' + category + '(' + e.toString() + ')'));\n            return;\n          }\n          var result1T = ListAll.listAllTupelWithContext(cats, a1.entity,\n            theModel.rules, theModel.records, categorySet);\n          // TODO classifying the string twice is a terrible waste\n          if (!result1T.length) {\n            debuglog('going for having');\n            var categorySetFull = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, false);\n            result1T = ListAll.listAllTupelHavingContext(cats, a1.entity, theModel.rules,\n              theModel.records, categorySetFull);\n          }\n          debuglog(debuglog.enabled? ('listall result:' + JSON.stringify(result1T)) : '-');\n          var joinresults = restrictLoggedOn(session, ListAll.joinResultsTupel(result1T));\n          logQueryWhatIsTupel(session, 'ListAll', result1T);\n          if (joinresults.length) {\n            dialoglog(\"ListAll\", session, send(\"the \" + category + \" for \" + a1.entity + \" are ...\\n\" + joinresults.join(\";\\n\")));\n          } else {\n            dialoglog(\"ListAll\", session, send(\"i did not find any \" + category + \" for \" + a1.entity + \".\\n\" + joinresults.join(\";\\n\")));\n          }\n          return;\n        } else {\n          // no entity, e.g. list all countries\n          //\n          var categorySetFull = {} as { [key: string]: boolean };\n          try {\n            categorySetFull = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, false);\n          } catch (e) {\n            debuglog(\"here exception\" + e);\n            dialoglog(\"WhatIs\", session, send('I cannot combine \"' + category + '(' + e.toString() + ')'));\n            // next();\n            return;\n          }\n          var resultT = ListAll.listAllTupelHavingContext(cats, \"\\\"\" + cats.join(\"\\\" \\\"\") + \"\\\"\", theModel.rules, theModel.records, categorySetFull);\n          logQueryWhatIsTupel(session, 'ListAll', resultT);\n          if (resultT.length) {\n            debuglog(debuglog.enabled? ('listall result:' + JSON.stringify(resultT)):'-');\n            var joinresults = [];\n            debuglog(\"here is cat>\" + cats.join(\", \"));\n            if (cat !== \"example question\") {\n              joinresults = restrictLoggedOn(session, ListAll.joinResultsTupel(resultT));\n            } else {\n              joinresults = ListAll.joinResultsTupel(resultT);\n            }\n            var response = \"the \" + category + \" are ...\\n\" + joinresults.join(\";\\n\");\n            dialoglog(\"ListAll\", session, send(response));\n            return;\n          } else {\n            var response = \"Found no data having \\\"\" + cat + \"\\\"\"\n            dialoglog(\"ListAll\", session, send(response));\n            return;\n          }\n        }\n      }\n    }\n  ]);\n\n\n  dialog.matches('buildtable', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : buildtable\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var categories = builder.EntityRecognizer.findEntity(args.entities, 'categories').entity;\n      debuglog(\"factOrCat is\" + categories);\n      var cats;\n      try {\n        cats = WhatIs.analyzeCategoryMultOnlyAndComma(categories, theModel.rules, message);\n        debuglog(\"here cats\" + cats.join(\",\"));\n      } catch (e) {\n        if (e) {\n          debuglog(\"here exception\" + e);\n          dialoglog(\"WhatIs\", session, send('I don\\'t know anything about \"' + categories + '\"(' + e.toString() + ')'));\n          // next();\n          return;\n        }\n      }\n      if (!cats || (cats.length === 0)) {\n        dialoglog(\"ListAll\", session, send('I did not find a category in \"' + categories + '\"'));\n        // next();\n        return;\n      }\n      var exec = MakeTable.makeTable(cats,theModel);\n  //      const exec = ExecServer.execTool(session.dialogData.result as IMatch.IToolMatch, theModel.records);\n        var reply = new builder.Message(session)\n          .text(exec.text)\n          .addEntity(exec.action);\n        // .addAttachment({ fallbackText: \"I don't know\", contentType: 'image/jpeg', contentUrl: \"www.wombat.org\" });\n        dialoglog(\"ShowMe\", session, send(reply));\n    }\n\n\n  ]);\n\n  dialog.matches('Describe', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : Describe\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var factEntity = builder.EntityRecognizer.findEntity(args.entities, 'A1');\n      var factOrCat = factEntity && factEntity.entity;\n      var domainEntity = builder.EntityRecognizer.findEntity(args.entities, 'D');\n      var domainS = domainEntity && domainEntity.entity;\n      var filterDomain = undefined;\n      if (domainS) {\n        filterDomain = ListAll.inferDomain(theModel, domainS);\n        debuglog(\"got domain\" + filterDomain);\n        if (!filterDomain) {\n          dialoglog(\"Describe\", session, send(\"I did not infer a domain restriction from \\\"\" + domainS + \"\\\". Specify an existing domain. (List all domains) to get exact names.\\n\"));\n          return;\n        }\n      }\n\n      debuglog(\"factOrCat is\" + factOrCat);\n      if (metawordsDescriptions[factOrCat.toLowerCase()]) {\n        // do we have a filter ?\n        var prefix = \"\";\n        if (filterDomain) {\n          prefix = '\"in domain \"' + filterDomain + '\" make no sense when matching a metaword.\\n';\n        }\n        debuglog(\"showing meta result\");\n        dialoglog(\"Describe\", session, send(prefix + '\"' + factOrCat + '\" is ' + metawordsDescriptions[factOrCat.toLowerCase()] + \"\"));\n        return;\n      }\n      var categories = [];\n      if (WhatIs.splitAtCommaAnd(factOrCat).length > 1) {\n        dialoglog(\"Describe\", session, send(\"Whoa, i can only explain one thing at a time, not \\\"\" + factOrCat + \"\\\". Please ask one at a time.\"));\n        return;\n        // getDomainsForCategory\n      }\n\n\n\n      var category = WhatIs.analyzeCategory(factOrCat, theModel.rules, message);\n      var catResults = [];\n      if (category) {\n        //TODO\n        catResults = Describe.describeCategory(category,filterDomain, theModel,message);\n      }\n\n      var resFact = Describe.describeFactInDomain(factOrCat, filterDomain,theModel);\n      if(catResults) {\n      var prefixed = catResults.map(res =>\n        `${Describe.sloppyOrExact(category, factOrCat, theModel)}  ${res}` );\n      }\n      if(catResults.length) {\n        resFact = prefixed.join(\"\\n\"); + \"\\n\" + resFact;\n      }\n      dialoglog(\"Describe\", session, send(resFact));\n      /*\n          var aRes = Model.getCategoriesForDomain(theModel, domain);\n           var res = restrictLoggedOn(session, aRes).join(\";\\n\");\n          dialoglog(\"ListAll\",session,send(\"my categories in domain \\\"\" + domain + \"\\\" are ...\\n\" + res));\n          return;\n        }\n      }\n      if (category === \"domains\") {\n        var res = restrictLoggedOn(session, theModel.domains).join(\";\\n\");\n        dialoglog(\"ListAll\",session, send(\"my domains are ...\\n\" + res));\n        return;\n      }\n      if (category === \"tools\") {\n        var res = restrictLoggedOn(session, theModel.tools).map(function (oTool) {\n          return oTool.name;\n        }).join(\";\\n\");\n        dialoglog(\"ListAll\", session,send(\"my tools are ...\\n\" + res));\n        return;\n      }\n      */\n\n      /*\n      var cats = [];\n        try {\n        cats = WhatIs.analyzeCategoryMult2(category, theModel.rules, message);\n        debuglog(\"here cats\" + cats.join(\",\"));\n      } catch (e) {\n          if(e) {\n            debuglog(\"here exception\" + e);\n            dialoglog(\"WhatIs\",session,send('I don\\'t know anything about \"' + category + '\"(' + e.toString() + ')'));\n            // next();\n            return;\n          }\n      }\n      if (!cats || (cats.length === 0)) {\n        dialoglog(\"ListAll\",session,send('I don\\'t know anything about \"' + category + '\"'));\n        // next();\n        return;\n      }\n      var cat = \"\";\n      if( cats.length === 1) {\n        cat = cats[0];\n      }\n      if( cats.length === 1) {\n        debuglog('category identified:' + cat);\n        if (a1 && a1.entity) {\n          debuglog('got filter:' + a1.entity);\n          var categorySet = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, true);\n          var result1 = ListAll.listAllWithContext(cat, a1.entity,\n            theModel.rules, theModel.records, categorySet);\n          // TODO classifying the string twice is a terrible waste\n          if (!result1.length) {\n            debuglog('going for having');\n            var categorySetFull = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, false);\n            result1 = ListAll.listAllHavingContext(cat, a1.entity, theModel.rules,\n              theModel.records, categorySetFull);\n          }\n          debuglog('listall result:' + JSON.stringify(result1));\n          var joinresults = restrictLoggedOn(session, ListAll.joinResults(result1));\n          logQueryWhatIs(session, 'ListAll', result1);\n          if(joinresults.length ){\n            dialoglog(\"ListAll\",session,send(\"the \" + category + \" for \" + a1.entity + \" are ...\\n\" + joinresults.join(\";\\n\")));\n          } else {\n            dialoglog(\"ListAll\",session,send(\"i did not find any \" + category + \" for \" + a1.entity + \".\\n\" + joinresults.join(\";\\n\")));\n          }\n          return;\n        } else {\n          // no entity, e.g. list all countries\n          //\n          var categorySetFull = Model.getAllRecordCategoriesForTargetCategory(theModel, cat, false);\n          var result = ListAll.listAllHavingContext(cat, cat, theModel.rules, theModel.records, categorySetFull);\n          logQueryWhatIs(session, 'ListAll', result);\n          if (result.length) {\n            debuglog('listall result:' + JSON.stringify(result));\n            var joinresults = [];\n            debuglog(\"here is cat>\" + cat);\n            if(cat !== \"example question\") {\n              joinresults = restrictLoggedOn(session, ListAll.joinResults(result));\n            } else {\n              joinresults = ListAll.joinResults(result);\n            }\n            var response = \"the \" + category + \" are ...\\n\" + joinresults.join(\";\\n\");\n            dialoglog(\"ListAll\",session,send(response));\n            return;\n          } else {\n            var response = \"Found no data having \\\"\" + cat + \"\\\"\"\n            dialoglog(\"ListAll\",session,send(response));\n            return;\n          }\n        }\n      } else {\n        // multiple categories\n        debuglog('categories identified:' + cats.join(\",\"));\n        if (a1 && a1.entity) {\n          debuglog('got filter:' + a1.entity);\n          try {\n          var categorySet = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, true);\n          } catch(e) {\n              debuglog(\"here exception\" + e);\n              dialoglog(\"WhatIs\",session,send('I cannot combine \"' + category + '(' + e.toString() + ')'));\n              return;\n          }\n          var result1T = ListAll.listAllTupelWithContext(cats, a1.entity,\n            theModel.rules, theModel.records, categorySet);\n          // TODO classifying the string twice is a terrible waste\n          if (!result1T.length) {\n            debuglog('going for having');\n            var categorySetFull = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, false);\n            result1T = ListAll.listAllTupelHavingContext(cats, a1.entity, theModel.rules,\n              theModel.records, categorySetFull);\n          }\n          debuglog('listall result:' + JSON.stringify(result1T));\n          var joinresults = restrictLoggedOn(session, ListAll.joinResultsTupel(result1T));\n          logQueryWhatIsTupel(session, 'ListAll', result1T);\n          if(joinresults.length ){\n            dialoglog(\"ListAll\",session,send(\"the \" + category + \" for \" + a1.entity + \" are ...\\n\" + joinresults.join(\";\\n\")));\n          } else {\n            dialoglog(\"ListAll\",session,send(\"i did not find any \" + category + \" for \" + a1.entity + \".\\n\" + joinresults.join(\";\\n\")));\n          }\n          return;\n        } else {\n          // no entity, e.g. list all countries\n          //\n          var categorySetFull = {} as { [key : string] : boolean};\n          try {\n            categorySetFull = Model.getAllRecordCategoriesForTargetCategories(theModel, cats, false);\n          } catch(e) {\n              debuglog(\"here exception\" + e);\n              dialoglog(\"WhatIs\",session,send('I cannot combine \"' + category + '(' + e.toString() + ')'));\n          // next();\n              return;\n          }\n          var resultT = ListAll.listAllTupelHavingContext(cats, \"\\\"\" + cats.join(\"\\\" \\\"\") + \"\\\"\", theModel.rules, theModel.records, categorySetFull);\n          logQueryWhatIsTupel(session, 'ListAll', resultT);\n          if (resultT.length) {\n            debuglog('listall result:' + JSON.stringify(resultT));\n            var joinresults = [];\n            debuglog(\"here is cat>\" + cats.join(\", \"));\n            if(cat !== \"example question\") {\n              joinresults = restrictLoggedOn(session, ListAll.joinResultsTupel(resultT));\n            } else {\n              joinresults = ListAll.joinResultsTupel(resultT);\n            }\n            var response = \"the \" + category + \" are ...\\n\" + joinresults.join(\";\\n\");\n            dialoglog(\"ListAll\",session,send(response));\n            return;\n          } else {\n            var response = \"Found no data having \\\"\" + cat + \"\\\"\"\n            dialoglog(\"ListAll\",session,send(response));\n            return;\n          }\n        }\n      }\n        */\n    }\n  ]);\n\n\n  dialog.matches('ListAllBinOp', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : ListAllBinOp\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'category');\n      var categoryWord = categoryEntity.entity;\n      var opEntity = builder.EntityRecognizer.findEntity(args.entities, 'operator');\n      var operatorWord = opEntity &&  opEntity.entity;\n      // categorize as operator ?\n      var filterDomainEntity =  builder.EntityRecognizer.findEntity(args.entities, 'domain');\n      var filterDomainS = filterDomainEntity && filterDomainEntity.entity;\n      var operator = WhatIs.analyzeOperator(operatorWord, theModel.rules, message);\n      var category = WhatIs.analyzeCategory(categoryWord, theModel.rules, message);\n      var operatorArgs = Model.getOperator(theModel, operator);\n      var a2 = builder.EntityRecognizer.findEntity(args.entities, 'A2');\n      if (!operator) {\n        var s = \"Unknown operator \" + operatorWord + \", this is a model bug, check operators.json and intents.json\";\n        dialoglog(\"ListAllBinOp\", session, send(\"ouch, this was in internal error. Recovering from a weird operator \\\"\"\n          + operatorWord + \"\\\"\\n\"));\n        throw new Error(s);\n      }\n      var filterDomain = undefined;\n      if (filterDomainS) {\n        debuglog(\"found a domainString\" + filterDomainS);\n        filterDomain = ListAll.inferDomain(theModel, filterDomainS);\n        debuglog(\"got domain\" + filterDomain);\n        if (!filterDomain) {\n          dialoglog(\"Describe\", session, send(\"I did not infer a domain restriction from \\\"\" + filterDomainS + \"\\\". Specify an existing domain. (List all domains) to get exact names.\\n\"));\n          return;\n        }\n      }\n\n      var fragment = a2 && a2.entity;\n      fragment = BreakDown.trimQuoted(BreakDown.trimQuotedSpaced(fragment));\n      debuglog(\"fragment after trimming \\\"\" + fragment + \"\\\"\");\n      if (categoryWord === \"categories\") {\n        // do we have a filter?\n        var aFilteredCategories = ListAll.filterStringListByOp(operatorArgs, fragment, theModel.category);\n        if(filterDomain) {\n          var catsForDomain = Model.getCategoriesForDomain(theModel,filterDomain);\n          aFilteredCategories = _.intersection(aFilteredCategories,catsForDomain);\n        }\n        res = restrictLoggedOn(session, aFilteredCategories).join(\";\\n\");\n        if (res.length) {\n          if(filterDomain) {\n            dialoglog(\"ListAllBinOp\", session, send(`my categories ${operator} \"${fragment}\" in domain \"${filterDomain}\" are ...\\n` + res));\n          }else {\n            dialoglog(\"ListAllBinOp\", session, send(`my categories ${operator} \"${fragment}\" are ...\\n` + res));\n          }\n        } else {\n          dialoglog(\"ListAllBinOp\", session, send('I have no categories ' + operator + ' \"' + fragment + '\"'));\n        }\n        return;\n      }\n      else if (categoryWord === \"domains\") {\n        var aRes = ListAll.filterStringListByOp(operatorArgs, fragment, theModel.domains);\n        res = restrictLoggedOn(session, aRes).join(\";\\n\");\n        if (res.length) {\n          dialoglog(\"ListAllBinOp\", session, send(\"my domains \" + operator + ' \"' + fragment + '\" are ...\\n' + res));\n        } else {\n          dialoglog(\"ListAllBinOp\", session, send('I have no domains ' + operator + ' \"' + fragment + '\"'));\n        }\n        return;\n      }\n      else if (categoryWord === \"tools\") {\n        var aRes = ListAll.filterStringListByOp(operatorArgs, fragment, theModel.tools.map(\n          function (oTool) { return oTool.name; }));\n        var res = restrictLoggedOn(session, aRes).join(\";\\n\");\n        if (res.length) {\n          dialoglog(\"ListAllBinOp\", session, send(\"my tools \" + operator + ' \"' + fragment + '\" are ...\\n' + res));\n        } else {\n          dialoglog(\"ListAllBinOp\", session, send(\"I have no tools \" + operator + ' \"' + fragment + '\"'));\n        }\n        return;\n      }\n      else { // category is category\n        var cat = WhatIs.analyzeCategory(categoryWord, theModel.rules, message);\n        if (!cat) {\n          dialoglog(\"ListAllBinOp\", session, send('I don\\'t know anything about \"' + categoryWord + '\"'));\n          // next();\n          return;\n        }\n        debuglog('category identified:' + cat);\n        var aRes = ListAll.getCategoryOpFilterAsDistinctStrings(operatorArgs, fragment, category, theModel.records, filterDomain);\n        var res = restrictLoggedOn(session, aRes).join(\";\\n\");\n        var infixExplain = ''\n        if (!ListAll.likelyPluralDiff(category, categoryWord)) {\n          infixExplain = '(\"' + category + '\")';\n        }\n        if (res.length) {\n          if (filterDomain) {\n            dialoglog(\"ListAllBinOp\", session, send(`my ${categoryWord}${infixExplain} ${operator} \"${fragment}\" in domain \"${filterDomain}\" are ...\\n` + res));\n\n          } else {\n            dialoglog(\"ListAllBinOp\", session, send(`my ${categoryWord}${infixExplain} ${operator} \"${fragment}\" are ...\\n` + res));\n          }\n        } else {\n          dialoglog(\"ListAllBinOp\", session, send('I have no ' + categoryWord + infixExplain + ' ' + operator + ' \"' + fragment + '\"'));\n        }\n        return;\n      }\n    }\n  ]);\n\n  dialog.matches('TrainMe', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : Train\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'categories');\n      if (message.toLowerCase().indexOf(\"kronos\") >= 0 || message.toLowerCase().indexOf(\"klingon\") >= 0) {\n        dialoglog(\"TrainMe\", session, send(getRandomResult(aTrainNoKlingon)));\n        return;\n      }\n      var res = getRandomResult(aTrainReplies);\n      dialoglog(\"TrainMe\", session, send(res));\n    }\n  ]);\n\n  dialog.matches('TooLong', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"Intent : TooLong\");\n      debuglog('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'categories');\n      dialoglog(\"TooLong\", session, send(getRandomResult(aResponsesOnTooLong)));\n    }\n  ]);\n\n\n  dialog.matches('Wrong', [\n    function (session, args, next) {\n      /*\n      dialogLogger({\n        session: session,\n        intent: \"Wrong\",\n        response: '<begin updown>'\n      }); */\n      session.beginDialog('/updown', session.userData.count);\n    },\n    function (session, results, next) {\n      var alarm = session.dialogData.alarm;\n      next();\n    },\n    function (session, results) {\n      session.send(getRandomResult(aBackFromTraining)); //  + JSON.stringify(results));\n      //session.send('end of wrong');\n    }\n  ]);\n\n  dialog.matches('Exit', [\n    function (session, args, next) {\n      debuglog('exit :');\n      debuglog('exit' + JSON.stringify(args.entities));\n      dialogLogger({\n        session: session,\n        intent: \"Exit\",\n        response: 'you are in a logic loop'\n      });\n      session.send(\"you are in a logic loop \");\n    }\n  ]);\n  dialog.matches('Help', [\n    function (session, args, next) {\n      debuglog('help :');\n      debuglog('help');\n      session.send(\"I know about .... <categories>>\");\n    }\n  ]);\n\n  // Add intent handlers\n  dialog.matches('train', [\n    function (session, args, next) {\n      debuglog('train');\n      // Resolve and store any entities passed from LUIS.\n      var title = builder.EntityRecognizer.findEntity(args.entities, 'builtin.alarm.title');\n      var time = builder.EntityRecognizer.resolveTime(args.entities);\n      var alarm = session.dialogData.alarm = {\n        title: title ? title.entity : null,\n        timestamp: time ? time.getTime() : null\n      };\n      // Prompt for title\n      if (!alarm.title) {\n        dialogLogger({\n          session: session,\n          intent: \"train\",\n          response: 'What fact would you like to train?'\n        });\n        builder.Prompts.text(session, 'What fact would you like to train?');\n      } else {\n        next();\n      }\n    },\n    function (session, results, next) {\n      var alarm = session.dialogData.alarm;\n      if (results.response) {\n        alarm.title = results.response;\n      }\n\n      // Prompt for time (title will be blank if the user said cancel)\n      if (alarm.title && !alarm.timestamp) {\n\n\n        builder.Prompts.time(session, 'What time would you like to set the alarm for?');\n      } else {\n        next();\n      }\n    },\n    function (session, results) {\n      var alarm = session.dialogData.alarm;\n      if (results.response) {\n        var time = builder.EntityRecognizer.resolveTime([results.response]);\n        alarm.timestamp = time ? time.getTime() : null;\n      }\n      // Set the alarm (if title or timestamp is blank the user said cancel)\n      if (alarm.title && alarm.timestamp) {\n        // Save address of who to notify and write to scheduler.\n        alarm.address = session.message.address;\n        //alarms[alarm.title] = alarm;\n\n        // Send confirmation to user\n        var date = new Date(alarm.timestamp);\n        var isAM = date.getHours() < 12;\n        session.send('Creating alarm named \"%s\" for %d/%d/%d %d:%02d%s',\n          alarm.title,\n          date.getMonth() + 1, date.getDate(), date.getFullYear(),\n          isAM ? date.getHours() : date.getHours() - 12, date.getMinutes(), isAM ? 'am' : 'pm');\n      } else {\n        session.send('Ok... no problem.');\n      }\n    }\n  ]);\n\n  dialog.onDefault(function (session) {\n    logQuery(session, \"onDefault\");\n    var eliza = getElizaBot(getConversationId(session));\n    var reply = eliza.transform(session.message.text);\n    dialoglog(\"eliza\", session, send(reply));\n    //new Eilzabot\n    //session.send(\"I do not understand this at all\");\n    //builder.DialogAction.send('I\\'m sorry I didn\\'t understand. I can only show start and ring');\n  });\n\n  /*\n  // Very simple alarm scheduler\n  var alarms = {};\n  setInterval(function () {\n    var now = new Date().getTime();\n    for (var key in alarms) {\n      var alarm = alarms[key];\n      if (now >= alarm.timestamp) {\n        var msg = new builder.Message()\n          .address(alarm.address)\n          .text('Here\\'s your \\'%s\\' alarm.', alarm.title);\n        bot.send(msg);\n        delete alarms[key];\n      }\n    }\n  }, 15000);\n  */\n}\n\nif (module) {\n  module.exports = {\n    SimpleUpDownRecognizer: SimpleUpDownRecognizer,\n    aResponsesOnTooLong: aResponsesOnTooLong,\n    metawordsDescriptions : metawordsDescriptions,\n    makeBot: makeBot\n  };\n}\n"],"sourceRoot":"ABC"}